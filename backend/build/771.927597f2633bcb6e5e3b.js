"use strict";(self.webpackChunkpayload_template_ts_blank=self.webpackChunkpayload_template_ts_blank||[]).push([[771],{59771:function(e,a,t){t.r(a),t.d(a,{default:function(){return g}});var i=t(67294),l=t(16550),n=t(26793),o=t(9980),s=t(28630),d=t(47489),r=t(2143),u=t(58951),c=t(83780);var f=(e,a)=>a?e.fields.filter((e=>(0,c.fieldAffectsData)(e)&&"id"!==e.name||!0)):e.fields,p=t(19826),v=t(40684),m=t(45074),$=t(91455),k=t(30894);var g=e=>{var a,t,c;const{collection:g,isEditing:h}=e,{slug:E,admin:{components:{views:{Edit:S}={}}={}}={}}=g,[b]=(0,i.useState)((()=>f(g,h))),[_]=(0,i.useState)((()=>({...g,fields:b}))),[w,C]=(0,i.useState)(),Z=(0,v.bU)(),{serverURL:y,routes:{admin:P,api:L}}=(0,o.Z)(),{params:{id:U}={}}=(0,l.$B)(),{state:D}=(0,l.TH)(),R=(0,l.k6)(),[x,A]=(0,i.useState)(),{permissions:B,user:G}=(0,s.a)(),{getVersions:H,preferencesKey:K}=(0,m.x5)(),{getPreference:T}=(0,$.G)(),{t:V}=(0,n.$)("general"),j=(0,i.useCallback)((async e=>{var a;if(H(),h){const a=await(0,p.Z)({fieldSchema:_.fields,data:e.doc,user:G,id:U,operation:"update",locale:Z,t:V});A(a)}else C(`${P}/collections/${_.slug}/${null===(a=null==e?void 0:e.doc)||void 0===a?void 0:a.id}`)}),[P,_,h,H,G,U,V,Z]),[{data:q,isLoading:z,isError:F}]=(0,d.Z)(h?`${y}${L}/${E}/${U}`:null,{initialParams:{"fallback-locale":"null",depth:0,draft:"true"}}),I=(null==D?void 0:D.data)||q;if((0,i.useEffect)((()=>{if(z)return;(async()=>{const e=await(0,p.Z)({fieldSchema:b,data:I,user:G,operation:h?"update":"create",id:U,locale:Z,t:V});await T(K),A(e)})()}),[I,b,h,U,G,Z,z,K,T,V]),(0,i.useEffect)((()=>{w&&R.push(w)}),[R,w]),F)return i.createElement(l.l_,{to:`${P}/not-found`});const J=null===(a=null==B?void 0:B.collections)||void 0===a?void 0:a[E],M=`${y}${L}/${E}/${U}${_.versions.drafts?"?draft=true":""}`,N=`${y}${L}/${E}${h?`/${U}`:""}?locale=${Z}&depth=0&fallback-locale=null`,O=h&&(null===(t=null==J?void 0:J.update)||void 0===t?void 0:t.permission)||!h&&(null===(c=null==J?void 0:J.create)||void 0===c?void 0:c.permission);return i.createElement(k.f.Provider,{value:1},i.createElement(r.Z,{DefaultComponent:u.Z,CustomComponent:S,componentProps:{id:U,isLoading:!x,data:I,collection:_,permissions:J,isEditing:h,onSave:j,initialState:x,hasSavePermission:O,apiURL:M,action:N}}))}}}]);