"use strict";(self.webpackChunkpayload_template_ts_blank=self.webpackChunkpayload_template_ts_blank||[]).push([[127],{89127:function(e,a,l){l.r(a),l.d(a,{default:function(){return I}});var t=l(67294),n=l(16550),i=l(26793),s=l(9980),r=l(28630),d=l(75091),o=l(47489),c=l(40684),m=l(2143),v=l(49546),u=l(28584),p=l(26644),f=l(4983),E=l(46268),_=l(5590),b=l(55532),$=l(37276),Z=l(24427),g=l(50854),h=l(8742),N=l(28019),w=l(40829),S=l(45074),k=l(8792),y=l(11750),L=l(24531),P=l(34088),U=l(9684),R=l(69850),A=l(28960);l(88446);const C="global-edit";var F=e=>{var a,l,n,r,d,o,c,m,F,D,T,I,x,M,O,G;const{admin:{dateFormat:H}}=(0,s.Z)(),{publishedDoc:K}=(0,S.x5)(),{t:V,i18n:j}=(0,i.$)("general"),{global:q,data:z,onSave:B,permissions:J,action:Q,apiURL:W,initialState:X,isLoading:Y}=e,{fields:ee,preview:ae,versions:le,label:te,admin:{description:ne,hideAPIURL:ie}={}}=q,se=null===(a=null==J?void 0:J.update)||void 0===a?void 0:a.permission;return t.createElement("div",{className:C},Y&&t.createElement(w.Z,null),!Y&&t.createElement(U.R.Provider,{value:"update"},t.createElement(p.Z,{className:`${C}__form`,method:"post",action:Q,onSuccess:B,disabled:!se,initialState:X},t.createElement("div",{className:`${C}__main`},t.createElement($.Z,{title:(0,A.i)(te,j),description:(0,A.i)(te,j),keywords:`${(0,A.i)(te,j)}, Payload, CMS`}),t.createElement(u.Z,null),!((null===(l=q.versions)||void 0===l?void 0:l.drafts)&&(null===(r=null===(n=q.versions)||void 0===n?void 0:n.drafts)||void 0===r?void 0:r.autosave))&&t.createElement(g.Z,null),t.createElement(R.T,{className:`${C}__edit`},t.createElement("header",{className:`${C}__header`},t.createElement("h1",null,V("editLabel",{label:(0,A.i)(te,j)})),ne&&t.createElement("div",{className:`${C}__sub-header`},t.createElement(N.Z,{description:ne}))),t.createElement(_.Z,{readOnly:!se,permissions:J.fields,filter:e=>!e.admin.position||e.admin.position&&"sidebar"!==e.admin.position,fieldTypes:Z.Z,fieldSchema:ee}))),t.createElement("div",{className:`${C}__sidebar-wrap`},t.createElement("div",{className:`${C}__sidebar`},t.createElement("div",{className:`${C}__sidebar-sticky-wrap`},t.createElement("div",{className:`${C}__document-actions${(null===(d=q.versions)||void 0===d?void 0:d.drafts)&&!(null===(c=null===(o=q.versions)||void 0===o?void 0:o.drafts)||void 0===c?void 0:c.autosave)||ae?` ${C}__document-actions--has-2`:""}`},ae&&(!(null===(m=q.versions)||void 0===m?void 0:m.drafts)||(null===(D=null===(F=q.versions)||void 0===F?void 0:F.drafts)||void 0===D?void 0:D.autosave))&&t.createElement(f.Z,{generatePreviewURL:ae,data:z}),se&&t.createElement(t.Fragment,null,(null===(T=q.versions)||void 0===T?void 0:T.drafts)&&t.createElement(t.Fragment,null,!q.versions.drafts.autosave&&t.createElement(k.Z,null),t.createElement(y.Z,null)),!(null===(I=q.versions)||void 0===I?void 0:I.drafts)&&t.createElement(E.Z,{buttonId:"action-save"},V("save")))),t.createElement("div",{className:`${C}__sidebar-fields`},ae&&(null===(x=q.versions)||void 0===x?void 0:x.drafts)&&!(null===(O=null===(M=q.versions)||void 0===M?void 0:M.drafts)||void 0===O?void 0:O.autosave)&&t.createElement(f.Z,{generatePreviewURL:ae,data:z}),(null===(G=q.versions)||void 0===G?void 0:G.drafts)&&t.createElement(t.Fragment,null,t.createElement(L.Z,null),q.versions.drafts.autosave&&se&&t.createElement(P.Z,{publishedDocUpdatedAt:(null==K?void 0:K.updatedAt)||(null==z?void 0:z.createdAt),global:q})),t.createElement(_.Z,{readOnly:!se,permissions:J.fields,filter:e=>"sidebar"===e.admin.position,fieldTypes:Z.Z,fieldSchema:ee})),t.createElement("ul",{className:`${C}__meta`},le&&t.createElement("li",null,t.createElement("div",{className:`${C}__label`},V("version:versions")),t.createElement(h.Z,{global:q})),z&&!ie&&t.createElement("li",{className:`${C}__api-url`},t.createElement("span",{className:`${C}__label`},"API URL"," ",t.createElement(b.Z,{value:W})),t.createElement("a",{href:W,target:"_blank",rel:"noopener noreferrer"},W)),z.updatedAt&&t.createElement("li",null,t.createElement("div",{className:`${C}__label`},V("lastModified")),t.createElement("div",null,(0,v.default)(new Date(z.updatedAt),H))))))))))},D=l(19826),T=l(91455);var I=e=>{var a,l;const{state:v}=(0,n.TH)(),u=(0,c.bU)(),{setStepNav:p}=(0,d.FP)(),{permissions:f,user:E}=(0,r.a)(),[_,b]=(0,t.useState)(),{getVersions:$,preferencesKey:Z}=(0,S.x5)(),{getPreference:g}=(0,T.G)(),{t:h}=(0,i.$)(),{serverURL:N,routes:{api:w}}=(0,s.Z)(),{global:k}=e,{slug:y,label:L,fields:P,admin:{components:{views:{Edit:U}={}}={}}={}}=k,R=(0,t.useCallback)((async e=>{$();const a=await(0,D.Z)({fieldSchema:P,data:e.result,operation:"update",user:E,locale:u,t:h});b(a)}),[$,P,E,u,h]),[{data:A}]=(0,o.Z)(`${N}${w}/globals/${y}`,{initialParams:{"fallback-locale":"null",depth:0,draft:"true"}}),C=(null==v?void 0:v.data)||A;(0,t.useEffect)((()=>{p([{label:L}])}),[p,L]),(0,t.useEffect)((()=>{(async()=>{const e=await(0,D.Z)({fieldSchema:P,data:C,user:E,operation:"update",locale:u,t:h});await g(Z),b(e)})()}),[C,P,E,u,g,Z,h]);const I=null===(a=null==f?void 0:f.globals)||void 0===a?void 0:a[y];return t.createElement(m.Z,{DefaultComponent:F,CustomComponent:U,componentProps:{isLoading:!_,data:C,permissions:I,initialState:_,global:k,onSave:R,apiURL:`${N}${w}/globals/${y}${(null===(l=k.versions)||void 0===l?void 0:l.drafts)?"?draft=true":""}`,action:`${N}${w}/globals/${y}?locale=${u}&depth=0&fallback-locale=null`}})}}}]);